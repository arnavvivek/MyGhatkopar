<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MyGhatkopar</title>
  <meta name="theme-color" content="#0ea5e9" />
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="icons/icon-192.png" sizes="192x192" />
  <link rel="apple-touch-icon" href="icons/icon-512.png" />

  <style>
    :root {
      --bg:#0b1220; --bg-soft:#0f172a; --card:#0f172a; --card-2:#111827;
      --text:#e5e7eb; --muted:#94a3b8; --border:#1f2937; --ring:#22d3ee;
      --emergency:#ef4444; --approval:#3b82f6; --notice:#f59e0b; --sos:#10b981;
      --radius:16px;
    }
    .light {
      --bg:#f6f7fb; --bg-soft:#f1f5f9; --card:#ffffff; --card-2:#ffffff;
      --text:#0f172a; --muted:#475569; --border:#e5e7eb;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background:linear-gradient(180deg,var(--bg) 0%, var(--bg-soft) 100%); color:var(--text);
      padding-bottom:84px;
    }
    header{
      position:sticky; top:0; z-index:20; backdrop-filter: blur(8px);
      background:linear-gradient(180deg, rgba(15,23,42,.9) 0%, rgba(15,23,42,.6) 100%);
      border-bottom:1px solid var(--border);
      padding:12px 16px;
    }
    .light header{ background:linear-gradient(180deg, rgba(255,255,255,.9) 0%, rgba(255,255,255,.7) 100%); }
    .topbar{display:flex;gap:12px;align-items:center;justify-content:space-between;}
    .title{display:flex;gap:10px;align-items:center;font-weight:800}
    .title .app{
      padding:6px 10px;border-radius:999px;background:#0ea5e922;color:#22d3ee;border:1px solid #155e75;
      font-size:12px; letter-spacing:.3px;
    }
    .actions{display:flex;gap:8px;align-items:center;}
    .iconbtn{
      border:1px solid var(--border); background:transparent; color:var(--text);
      padding:8px 10px;border-radius:12px; cursor:pointer;
    }
    .searchrow{display:flex;gap:8px;margin-top:10px}
    .searchrow input, .searchrow select, .searchrow select#lang {
      flex:1; padding:11px 12px; border-radius:14px; border:1px solid var(--border);
      background:var(--card); color:var(--text);
    }
    .searchrow select#lang{flex:0 0 160px}
    .chips{display:flex; gap:8px; overflow:auto; padding:8px 0 2px 0}
    .chip{
      padding:8px 12px; border-radius:999px; border:1px solid var(--border);
      background:var(--card-2); color:var(--text); font-size:13px; white-space:nowrap; cursor:pointer;
    }
    .chip.active{ outline:2px solid var(--ring); }
    main{padding:16px; display:grid; gap:12px; max-width:900px; margin:0 auto;}
    .card{
      background:var(--card); border:1px solid var(--border); border-radius:var(--radius);
      padding:14px; box-shadow: 0 10px 30px rgba(0,0,0,.12);
      animation: rise .35s ease both;
    }
    @keyframes rise{ from{opacity:0; transform: translateY(8px)} to{opacity:1; transform:none} }
    .card h3{margin:6px 0 8px; font-size:1rem}
    .meta{font-size:12px;color:var(--muted); margin-bottom:6px; display:flex; gap:10px; flex-wrap:wrap}
    .badge{display:inline-flex; align-items:center; gap:6px; padding:4px 8px; border-radius:999px; font-size:12px; font-weight:700; color:#0b1220}
    .badge.emergency{background: #fecaca;}
    .badge.approvals{background:#bfdbfe;}
    .badge.notices{background:#fde68a;}
    .badge.sos{background:#bbf7d0;}
    .actions-row{display:flex; gap:8px; flex-wrap:wrap; margin-top:10px}
    .btn{padding:8px 12px; border-radius:12px; border:1px solid var(--border); background:var(--card-2); color:var(--text); cursor:pointer; font-size:13px; text-decoration:none; display:inline-block}
    .btn.primary{ background:#0ea5e9; color:#00111a; border:none; }
    .btn.call{ background: #10b981; color:#00110a; border:none; }
    .empty{opacity:.7; text-align:center; padding:40px 10px}
    .bottomnav{
      position:fixed; left:0; right:0; bottom:0; height:72px; display:flex; gap:6px; justify-content:space-around; align-items:center;
      background:linear-gradient(180deg, rgba(15,23,42,.85) 0%, rgba(15,23,42,.95) 100%);
      border-top:1px solid var(--border); z-index:30;
    }
    .light .bottomnav{ background:linear-gradient(180deg, rgba(255,255,255,.85) 0%, rgba(255,255,255,.95) 100%); }
    .navbtn{
      display:flex; flex-direction:column; align-items:center; gap:4px; font-size:12px; color:#cbd5e1; background:transparent; border:none; cursor:pointer;
    }
    .light .navbtn{ color:#334155; }
    .navbtn.active{ color:#22d3ee; font-weight:700 }
    .install-tip{ position:fixed; bottom:84px; right:16px; background:#0ea5e9; color:#06232c; padding:10px 12px; border-radius:12px; font-size:12px; display:none }
    .hidden{display:none}
    a.link{color:#38bdf8; text-decoration:none}
  </style>
</head>

<body>
  <header>
    <div class="topbar">
      <div class="title">
        <img src="icons/icon-192.png" alt="app" width="28" height="28" style="border-radius:8px;box-shadow:0 0 0 1px var(--border)" />
        <div>
          <div id="appName">MyGhatkopar</div>
          <div class="app" id="appTag">Community updates ‚Ä¢ Offline</div>
        </div>
      </div>
      <div class="actions">
        <select id="lang" aria-label="Language">
          <option value="en">English</option>
          <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
          <option value="mr">‡§Æ‡§∞‡§æ‡§†‡•Ä</option>
        </select>
        <button id="darkToggle" class="iconbtn" title="Toggle Dark">üåô</button>
        <button id="shareApp" class="iconbtn" title="Share App">üîó</button>
      </div>
    </div>

    <div class="searchrow">
      <input id="search" placeholder="Search updates e.g. water cut, fire, metro..." />
      <select id="sort" aria-label="Sort">
        <option value="new">Newest</option>
        <option value="old">Oldest</option>
      </select>
    </div>

    <div class="chips" id="chips">
      <div class="chip active" data-section="all">All</div>
      <div class="chip" data-section="emergency">üö® Emergency</div>
      <div class="chip" data-section="approvals">üèõ Approvals</div>
      <div class="chip" data-section="notices">üì¢ Notices</div>
      <div class="chip" data-section="sos">‚òé SOS</div>
    </div>
  </header>

  <main id="list" aria-live="polite"></main>

  <div class="install-tip" id="installTip">Tap Menu ‚ãÆ ‚Üí Add to Home screen</div>

  <nav class="bottomnav" role="navigation" aria-label="Bottom">
    <button class="navbtn active" data-section="all">üè† <span id="navHome">Home</span></button>
    <button class="navbtn" data-section="emergency">üö® <span id="navEmergency">Emergency</span></button>
    <button class="navbtn" data-section="approvals">üèõ <span id="navApprovals">Approvals</span></button>
    <button class="navbtn" data-section="notices">üì¢ <span id="navNotices">Notices</span></button>
    <button class="navbtn" data-section="sos">‚òé <span id="navSOS">SOS</span></button>
  </nav>

  <script>
    // ---------- PWA registration ----------
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js').catch(()=>{});
    }

    // ---------- i18n strings ----------
    const t = {
      en: {
        appName: "MyGhatkopar",
        appTag: "Community updates ‚Ä¢ Offline",
        searchPH: "Search updates e.g. water cut, fire, metro...",
        tabs: {all:"All", emergency:"üö® Emergency", approvals:"üèõ Approvals", notices:"üì¢ Notices", sos:"‚òé SOS"},
        nav: {home:"Home", emergency:"Emergency", approvals:"Approvals", notices:"Notices", sos:"SOS"},
        share: "Share", map: "Map", call: "Call", altCall: "Alt Call",
        empty: "No updates."
      },
      hi: {
        appName: "‡§Æ‡§æ‡§Ø ‡§ò‡§æ‡§ü‡§ï‡•ã‡§™‡§∞",
        appTag: "‡§∏‡§Æ‡•Å‡§¶‡§æ‡§Ø ‡§Ö‡§™‡§°‡•á‡§ü ‚Ä¢ ‡§ë‡§´‡§º‡§≤‡§æ‡§á‡§®",
        searchPH: "‡§ñ‡•ã‡§ú‡•á‡§Ç: ‡§™‡§æ‡§®‡•Ä ‡§ï‡§ü, ‡§Ü‡§ó, ‡§Æ‡•á‡§ü‡•ç‡§∞‡•ã...",
        tabs: {all:"‡§∏‡§≠‡•Ä", emergency:"üö® ‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤", approvals:"üèõ ‡§Ö‡§®‡•Å‡§Æ‡•ã‡§¶‡§®", notices:"üì¢ ‡§®‡•ã‡§ü‡§ø‡§∏", sos:"‚òé ‡§Ü‡§™‡§æ‡§§ ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ"},
        nav: {home:"‡§π‡•ã‡§Æ", emergency:"‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤", approvals:"‡§Ö‡§®‡•Å‡§Æ‡•ã‡§¶‡§®", notices:"‡§®‡•ã‡§ü‡§ø‡§∏", sos:"‡§Ü‡§™‡§æ‡§§"},
        share: "‡§∂‡•á‡§Ø‡§∞", map: "‡§Æ‡§æ‡§®‡§ö‡§ø‡§§‡•ç‡§∞", call: "‡§ï‡•â‡§≤", altCall: "‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï ‡§ï‡•â‡§≤",
        empty: "‡§ï‡•ã‡§à ‡§Ö‡§™‡§°‡•á‡§ü ‡§®‡§π‡•Ä‡§Ç."
      },
      mr: {
        appName: "‡§Æ‡§æ‡§Ø ‡§ò‡§æ‡§ü‡§ï‡•ã‡§™‡§∞",
        appTag: "‡§∏‡§Æ‡•Å‡§¶‡§æ‡§Ø ‡§Ö‡§¶‡•ç‡§Ø‡§§‡§® ‚Ä¢ ‡§ë‡§´‡§≤‡§æ‡§á‡§®",
        searchPH: "‡§∂‡•ã‡§ß‡§æ: ‡§™‡§æ‡§£‡•Ä ‡§ï‡§™‡§æ‡§§, ‡§Ü‡§ó, ‡§Æ‡•á‡§ü‡•ç‡§∞‡•ã...",
        tabs: {all:"‡§∏‡§∞‡•ç‡§µ", emergency:"üö® ‡§Ü‡§™‡§§‡•ç‡§ï‡§æ‡§≤", approvals:"üèõ ‡§Æ‡§æ‡§®‡•ç‡§Ø‡§§‡§æ", notices:"üì¢ ‡§∏‡•Ç‡§ö‡§®‡§æ", sos:"‚òé ‡§Ü‡§™‡§§‡•ç‡§ï‡§æ‡§≤‡•Ä‡§®"},
        nav: {home:"‡§Æ‡•Å‡§ñ‡•ç‡§Ø", emergency:"‡§Ü‡§™‡§§‡•ç‡§ï‡§æ‡§≤", approvals:"‡§Æ‡§æ‡§®‡•ç‡§Ø‡§§‡§æ", notices:"‡§∏‡•Ç‡§ö‡§®‡§æ", sos:"‡§Ü‡§™‡§§‡•ç‡§ï‡§æ‡§≤‡•Ä‡§®"},
        share: "‡§∂‡•á‡§Ö‡§∞", map: "‡§®‡§ï‡§æ‡§∂‡§æ", call: "‡§ï‡•â‡§≤", altCall: "‡§™‡§∞‡•ç‡§Ø‡§æ‡§Ø‡•Ä ‡§ï‡•â‡§≤",
        empty: "‡§ï‡•ã‡§£‡§§‡•á‡§π‡•Ä ‡§Ö‡§¶‡•ç‡§Ø‡§§‡§® ‡§®‡§æ‡§π‡•Ä."
      }
    };

    // ---------- Demo data (localized titles/descriptions; phone links always work) ----------
    const data = {
      en: [
        {id:1,type:'emergency',title:'Minor fire near R City Mall',details:'Fire brigade contained a small blaze near service lane. No casualties.',area:'LBS Marg, Amrut Nagar (W)',when:new Date().toISOString()},
        {id:2,type:'emergency',title:'Waterlogging on Station Road',details:'Traffic diverted via Tilak Road; expect delays.',area:'Ghatkopar East',when:new Date(Date.now()-3600e3).toISOString()},
        {id:3,type:'approvals',title:'90 Feet Road widening sanctioned',details:'Phase-wise expansion approved to ease congestion.',area:'Ghatkopar East',when:'2025-08-20T10:00:00'},
        {id:4,type:'approvals',title:'Footpath improvements approved',details:'Ramps and tiling near Pant Nagar market.',area:'Pant Nagar',when:'2025-08-18T09:30:00'},
        {id:5,type:'notices',title:'Water cut tomorrow 10:00‚Äì16:00',details:'Valve replacement; store water in advance.',area:'Pant Nagar, Garodia Nagar',when:'2025-08-26T10:00:00'},
        {id:6,type:'notices',title:'Planned power maintenance 14:00‚Äì16:00',details:'Elevators may be unavailable.',area:'Ghatkopar West',when:'2025-08-27T14:00:00'},
        {id:7,type:'sos',title:'Rajawadi Hospital ‚Äì Emergency',details:'24√ó7 casualty.',area:'Ghatkopar East',when:new Date().toISOString(),phone:'+912225115066',link:'https://maps.google.com/?q=Rajawadi+Hospital+Ghatkopar'},
        {id:8,type:'sos',title:'Pant Nagar Police Station',details:'Police assistance.',area:'Pant Nagar',when:new Date().toISOString(),phone:'+912225013624',phone2:'+912221028914',link:'https://maps.google.com/?q=Pant+Nagar+Police+Station+Ghatkopar'},
        {id:9,type:'sos',title:'Fire Brigade (Mumbai Control Room)',details:'City fire emergency.',area:'Citywide',when:new Date().toISOString(),phone:'101',phone2:'+912223076111'},
        {id:10,type:'sos',title:'Ambulance (108)',details:'State emergency ambulance service.',area:'Citywide',when:new Date().toISOString(),phone:'108'}
      ],
      hi: [
        {id:1,type:'emergency',title:'‡§Ü‡§∞ ‡§∏‡§ø‡§ü‡•Ä ‡§Æ‡•â‡§≤ ‡§ï‡•á ‡§™‡§æ‡§∏ ‡§Æ‡§æ‡§Æ‡•Ç‡§≤‡•Ä ‡§Ü‡§ó',details:'‡§´‡§æ‡§Ø‡§∞ ‡§¨‡•ç‡§∞‡§ø‡§ó‡•á‡§° ‡§®‡•á ‡§Ü‡§ó ‡§™‡§∞ ‡§ï‡§æ‡§¨‡•Ç ‡§™‡§æ ‡§≤‡§ø‡§Ø‡§æ‡•§ ‡§ï‡•ã‡§à ‡§π‡§§‡§æ‡§π‡§§ ‡§®‡§π‡•Ä‡§Ç‡•§',area:'‡§è‡§≤‡§¨‡•Ä‡§è‡§∏ ‡§Æ‡§æ‡§∞‡•ç‡§ó, ‡§Ö‡§Æ‡•É‡§§ ‡§®‡§ó‡§∞ (‡§™.)',when:new Date().toISOString()},
        {id:2,type:'emergency',title:'‡§∏‡•ç‡§ü‡•á‡§∂‡§® ‡§∞‡•ã‡§° ‡§™‡§∞ ‡§™‡§æ‡§®‡•Ä ‡§≠‡§∞‡§æ‡§µ',details:'‡§ü‡•ç‡§∞‡•à‡§´‡§ø‡§ï ‡§§‡§ø‡§≤‡§ï ‡§∞‡•ã‡§° ‡§ï‡•Ä ‡§ì‡§∞ ‡§Æ‡•ã‡§°‡§º‡§æ ‡§ó‡§Ø‡§æ‡•§',area:'‡§ò‡§æ‡§ü‡§ï‡•ã‡§™‡§∞ (‡§™‡•Ç.)',when:new Date(Date.now()-3600e3).toISOString()},
        {id:3,type:'approvals',title:'90 ‡§´‡•Ä‡§ü ‡§∞‡•ã‡§° ‡§ö‡•å‡§°‡§º‡•Ä‡§ï‡§∞‡§£ ‡§∏‡•ç‡§µ‡•Ä‡§ï‡•É‡§§',details:'‡§≠‡•Ä‡§°‡§º ‡§ï‡§Æ ‡§ï‡§∞‡§®‡•á ‡§π‡•á‡§§‡•Å ‡§∏‡•ç‡§µ‡•Ä‡§ï‡•É‡§§‡§ø‡•§',area:'‡§ò‡§æ‡§ü‡§ï‡•ã‡§™‡§∞ (‡§™‡•Ç.)',when:'2025-08-20T10:00:00'},
        {id:4,type:'approvals',title:'‡§´‡•Å‡§ü‡§™‡§æ‡§• ‡§∏‡•Å‡§ß‡§æ‡§∞ ‡§Ø‡•ã‡§ú‡§®‡§æ',details:'‡§™‡•á‡§Ç‡§ü ‡§®‡§ó‡§∞ ‡§¨‡§æ‡§ú‡§æ‡§∞ ‡§ï‡•á ‡§™‡§æ‡§∏ ‡§∞‡•à‡§Ç‡§™ ‡§µ ‡§ü‡§æ‡§á‡§≤‡§ø‡§Ç‡§ó‡•§',area:'‡§™‡§Ç‡§§ ‡§®‡§ó‡§∞',when:'2025-08-18T09:30:00'},
        {id:5,type:'notices',title:'‡§ï‡§≤ 10:00‚Äì16:00 ‡§™‡§æ‡§®‡•Ä ‡§¨‡§Ç‡§¶',details:'‡§µ‡§æ‡§≤‡•ç‡§µ ‡§¨‡§¶‡§≤‡§®‡•á ‡§ï‡§æ ‡§ï‡§æ‡§Æ; ‡§™‡§æ‡§®‡•Ä ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§≠‡§∞‡•á‡§Ç‡•§',area:'‡§™‡§Ç‡§§ ‡§®‡§ó‡§∞, ‡§ó‡§∞‡•ã‡§°‡§ø‡§Ø‡§æ ‡§®‡§ó‡§∞',when:'2025-08-26T10:00:00'},
        {id:6,type:'notices',title:'‡§®‡§ø‡§Ø‡•ã‡§ú‡§ø‡§§ ‡§¨‡§ø‡§ú‡§≤‡•Ä ‡§¨‡§Ç‡§¶ 14:00‚Äì16:00',details:'‡§≤‡§ø‡§´‡•ç‡§ü ‡§Ö‡§∏‡•ç‡§•‡§æ‡§Ø‡•Ä ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§¨‡§Ç‡§¶ ‡§∞‡§π ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡•§',area:'‡§ò‡§æ‡§ü‡§ï‡•ã‡§™‡§∞ (‡§™.)',when:'2025-08-27T14:00:00'},
        {id:7,type:'sos',title:'‡§∞‡§æ‡§ú‡§æ‡§µ‡§æ‡§°‡•Ä ‡§Ö‡§∏‡•ç‡§™‡§§‡§æ‡§≤ ‚Äì ‡§Ü‡§™‡§æ‡§§',details:'24√ó7 ‡§Ü‡§™‡§æ‡§§ ‡§∏‡•á‡§µ‡§æ‡•§',area:'‡§ò‡§æ‡§ü‡§ï‡•ã‡§™‡§∞ (‡§™‡•Ç.)',when:new Date().toISOString(),phone:'+912225115066',link:'https://maps.google.com/?q=Rajawadi+Hospital+Ghatkopar'},
        {id:8,type:'sos',title:'‡§™‡§Ç‡§§ ‡§®‡§ó‡§∞ ‡§™‡•Å‡§≤‡§ø‡§∏ ‡§∏‡•ç‡§ü‡•á‡§∂‡§®',details:'‡§™‡•Å‡§≤‡§ø‡§∏ ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ‡•§',area:'‡§™‡§Ç‡§§ ‡§®‡§ó‡§∞',when:new Date().toISOString(),phone:'+912225013624',phone2:'+912221028914',link:'https://maps.google.com/?q=Pant+Nagar+Police+Station+Ghatkopar'},
        {id:9,type:'sos',title:'‡§´‡§æ‡§Ø‡§∞ ‡§¨‡•ç‡§∞‡§ø‡§ó‡•á‡§° (‡§Æ‡•Å‡§Ç‡§¨‡§à ‡§ï‡§Ç‡§ü‡•ç‡§∞‡•ã‡§≤ ‡§∞‡•Ç‡§Æ)',details:'‡§∂‡§π‡§∞ ‡§Ö‡§ó‡•ç‡§®‡§ø ‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤‡•§',area:'‡§∏‡§Æ‡•Ç‡§ö‡§æ ‡§∂‡§π‡§∞',when:new Date().toISOString(),phone:'101',phone2:'+912223076111'},
        {id:10,type:'sos',title:'‡§è‡§Æ‡•ç‡§¨‡•Å‡§≤‡•á‡§Ç‡§∏ (108)',details:'‡§∞‡§æ‡§ú‡•ç‡§Ø ‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤‡•Ä‡§® ‡§è‡§Æ‡•ç‡§¨‡•Å‡§≤‡•á‡§Ç‡§∏ ‡§∏‡•á‡§µ‡§æ‡•§',area:'‡§∏‡§Æ‡•Ç‡§ö‡§æ ‡§∂‡§π‡§∞',when:new Date().toISOString(),phone:'108'}
      ],
      mr: [
        {id:1,type:'emergency',title:'‡§Ü‡§∞ ‡§∏‡§ø‡§ü‡•Ä ‡§Æ‡•â‡§≤‡§ú‡§µ‡§≥ ‡§ï‡§ø‡§∞‡§ï‡•ã‡§≥ ‡§Ü‡§ó',details:'‡§´‡§æ‡§Ø‡§∞ ‡§¨‡•ç‡§∞‡§ø‡§ó‡•á‡§°‡§®‡•á ‡§Ü‡§ó ‡§µ‡§ø‡§ù‡§µ‡§≤‡•Ä. ‡§ï‡•ã‡§£‡§§‡•Ä‡§π‡•Ä ‡§ú‡•Ä‡§µ‡§ø‡§§‡§π‡§æ‡§®‡•Ä ‡§®‡§æ‡§π‡•Ä.',area:'‡§è‡§≤‡§¨‡•Ä‡§è‡§∏ ‡§Æ‡§æ‡§∞‡•ç‡§ó, ‡§Ö‡§Æ‡•É‡§§ ‡§®‡§ó‡§∞ (‡§™.)',when:new Date().toISOString()},
        {id:2,type:'emergency',title:'‡§∏‡•ç‡§ü‡•á‡§∂‡§® ‡§∞‡•ã‡§°‡§µ‡§∞ ‡§™‡§æ‡§£‡•Ä ‡§∏‡§æ‡§ö‡§£‡•á',details:'‡§µ‡§æ‡§π‡§§‡•Ç‡§ï ‡§§‡§ø‡§≤‡§ï ‡§∞‡§∏‡•ç‡§§‡•ç‡§Ø‡§æ‡§ï‡§°‡•á ‡§µ‡§≥‡§µ‡§≤‡•Ä.',area:'‡§ò‡§æ‡§ü‡§ï‡•ã‡§™‡§∞ (‡§™‡•Ç.)',when:new Date(Date.now()-3600e3).toISOString()},
        {id:3,type:'approvals',title:'90 ‡§´‡•Ç‡§ü ‡§∞‡•ã‡§° ‡§∞‡•Å‡§Ç‡§¶‡•Ä‡§ï‡§∞‡§£ ‡§Æ‡§Ç‡§ú‡•Ç‡§∞',details:'‡§µ‡§æ‡§π‡§§‡•Ç‡§ï ‡§ï‡•ã‡§Ç‡§°‡•Ä ‡§ï‡§Æ‡•Ä ‡§ï‡§∞‡§£‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä ‡§Æ‡§Ç‡§ú‡•Å‡§∞‡•Ä.',area:'‡§ò‡§æ‡§ü‡§ï‡•ã‡§™‡§∞ (‡§™‡•Ç.)',when:'2025-08-20T10:00:00'},
        {id:4,type:'approvals',title:'‡§´‡•Å‡§ü‡§™‡§æ‡§• ‡§∏‡•Å‡§ß‡§æ‡§∞ ‡§™‡•ç‡§∞‡§ï‡§≤‡•ç‡§™',details:'‡§™‡§Ç‡§§ ‡§®‡§ó‡§∞ ‡§¨‡§æ‡§ú‡§æ‡§∞‡§æ‡§ú‡§µ‡§≥ ‡§∞‡•Ö‡§Æ‡•ç‡§™ ‡§µ ‡§ü‡§æ‡§á‡§≤‡§ø‡§Ç‡§ó.',area:'‡§™‡§Ç‡§§ ‡§®‡§ó‡§∞',when:'2025-08-18T09:30:00'},
        {id:5,type:'notices',title:'‡§â‡§¶‡•ç‡§Ø‡§æ 10:00‚Äì16:00 ‡§™‡§æ‡§£‡•Ä ‡§ï‡§™‡§æ‡§§',details:'‡§µ‡•ç‡§π‡•â‡§≤‡•ç‡§µ ‡§¨‡§¶‡§≤; ‡§™‡§æ‡§£‡•Ä ‡§∏‡§æ‡§†‡§µ‡§æ.',area:'‡§™‡§Ç‡§§ ‡§®‡§ó‡§∞, ‡§ó‡§∞‡•ã‡§°‡§ø‡§Ø‡§æ ‡§®‡§ó‡§∞',when:'2025-08-26T10:00:00'},
        {id:6,type:'notices',title:'‡§®‡§ø‡§Ø‡§§ ‡§µ‡•Ä‡§ú ‡§¶‡•á‡§ñ‡§≠‡§æ‡§≤ 14:00‚Äì16:00',details:'‡§≤‡§ø‡§´‡•ç‡§ü ‡§§‡§æ‡§§‡•ç‡§™‡•Å‡§∞‡§§‡•Ä ‡§¨‡§Ç‡§¶ ‡§Ö‡§∏‡•Ç ‡§∂‡§ï‡§§‡•á.',area:'‡§ò‡§æ‡§ü‡§ï‡•ã‡§™‡§∞ (‡§™.)',when:'2025-08-27T14:00:00'},
        {id:7,type:'sos',title:'‡§∞‡§æ‡§ú‡§æ‡§µ‡§æ‡§°‡•Ä ‡§∞‡•Å‡§ó‡•ç‡§£‡§æ‡§≤‡§Ø ‚Äì ‡§Ü‡§™‡§§‡•ç‡§ï‡§æ‡§≤',details:'24√ó7 ‡§Ü‡§™‡§§‡§ï‡§æ‡§≤‡•Ä‡§® ‡§∏‡•á‡§µ‡§æ.',area:'‡§ò‡§æ‡§ü‡§ï‡•ã‡§™‡§∞ (‡§™‡•Ç.)',when:new Date().toISOString(),phone:'+912225115066',link:'https://maps.google.com/?q=Rajawadi+Hospital+Ghatkopar'},
        {id:8,type:'sos',title:'‡§™‡§Ç‡§§ ‡§®‡§ó‡§∞ ‡§™‡•ã‡§≤‡•Ä‡§∏ ‡§†‡§æ‡§£‡•á',details:'‡§™‡•ã‡§≤‡•Ä‡§∏ ‡§Æ‡§¶‡§§.',area:'‡§™‡§Ç‡§§ ‡§®‡§ó‡§∞',when:new Date().toISOString(),phone:'+912225013624',phone2:'+912221028914',link:'https://maps.google.com/?q=Pant+Nagar+Police+Station+Ghatkopar'},
        {id:9,type:'sos',title:'‡§´‡§æ‡§Ø‡§∞ ‡§¨‡•ç‡§∞‡§ø‡§ó‡•á‡§° (‡§Æ‡•Å‡§Ç‡§¨‡§à ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§£ ‡§ï‡§ï‡•ç‡§∑)',details:'‡§∂‡§π‡§∞ ‡§Ö‡§ó‡•ç‡§®‡§ø ‡§Ü‡§™‡§§‡•ç‡§ï‡§æ‡§≤.',area:'‡§Æ‡•Å‡§Ç‡§¨‡§à',when:new Date().toISOString(),phone:'101',phone2:'+912223076111'},
        {id:10,type:'sos',title:'‡•≤‡§Æ‡•ç‡§¨‡•ç‡§Ø‡•Å‡§≤‡§®‡•ç‡§∏ (108)',details:'‡§∞‡§æ‡§ú‡•ç‡§Ø ‡§Ü‡§™‡§§‡§ï‡§æ‡§≤‡•Ä‡§® ‡•≤‡§Æ‡•ç‡§¨‡•ç‡§Ø‡•Å‡§≤‡§®‡•ç‡§∏ ‡§∏‡•á‡§µ‡§æ.',area:'‡§Æ‡•Å‡§Ç‡§¨‡§à',when:new Date().toISOString(),phone:'108'}
      ]
    };

    // ---------- State ----------
    const state = {
      section: 'all',
      search: '',
      sort: 'new',
      lang: localStorage.getItem('lang') || 'en',
      dark: localStorage.getItem('dark') === '1'
    };

    // ---------- Elements ----------
    const listEl = document.getElementById('list');
    const chips = document.querySelectorAll('#chips .chip');
    const navbtns = document.querySelectorAll('.navbtn');
    const searchInput = document.getElementById('search');
    const sortSelect = document.getElementById('sort');
    const langSelect = document.getElementById('lang');
    const appNameEl = document.getElementById('appName');
    const appTagEl = document.getElementById('appTag');
    const darkToggle = document.getElementById('darkToggle');

    // ---------- UI helpers ----------
    const labelMap = (lng)=>({
      emergency:'üö® ' + t[lng].tabs.emergency.replace('üö® ',''),
      approvals:'üèõ ' + t[lng].tabs.approvals.replace('üèõ ',''),
      notices:'üì¢ ' + t[lng].tabs.notices.replace('üì¢ ',''),
      sos:'‚òé ' + t[lng].tabs.sos.replace('‚òé ',''),
    });
    function badge(type,lng){
      const m = labelMap(lng);
      return `<span class="badge ${type}">${m[type]||type}</span>`;
    }
    function iconFor(type){
      return type==='emergency'?'üö®':type==='approvals'?'üèóÔ∏è':type==='notices'?'üì¢':'‚òé';
    }

    function applyLang(){
      const lng = state.lang;
      langSelect.value = lng;
      appNameEl.textContent = t[lng].appName;
      appTagEl.textContent = t[lng].appTag;
      searchInput.placeholder = t[lng].searchPH;
      document.querySelector('[data-section="all"]').textContent = t[lng].tabs.all;
      document.querySelector('[data-section="emergency"]').textContent = t[lng].tabs.emergency;
      document.querySelector('[data-section="approvals"]').textContent = t[lng].tabs.approvals;
      document.querySelector('[data-section="notices"]').textContent = t[lng].tabs.notices;
      document.querySelector('[data-section="sos"]').textContent = t[lng].tabs.sos;
      document.getElementById('navHome').textContent = t[lng].nav.home;
      document.getElementById('navEmergency').textContent = t[lng].nav.emergency;
      document.getElementById('navApprovals').textContent = t[lng].nav.approvals;
      document.getElementById('navNotices').textContent = t[lng].nav.notices;
      document.getElementById('navSOS').textContent = t[lng].nav.sos;
      localStorage.setItem('lang', lng);
      render();
    }

    function applyDark(){
      document.documentElement.style.colorScheme = state.dark ? 'dark' : 'light';
      document.body.classList.toggle('light', !state.dark);
      localStorage.setItem('dark', state.dark?'1':'0');
      darkToggle.textContent = state.dark ? 'üåô' : '‚òÄÔ∏è';
    }

    function render(){
      const lng = state.lang;
      let items = data[lng].slice();
      if(state.section!=='all') items = items.filter(x=>x.type===state.section);
      if(state.search) items = items.filter(x => (x.title+x.details+x.area).toLowerCase().includes(state.search.toLowerCase()));
      items.sort((a,b)=> state.sort==='new' ? (new Date(b.when)-new Date(a.when)) : (new Date(a.when)-new Date(b.when)));

      listEl.innerHTML = items.map(x => {
        const whenStr = new Date((x.when||'').toString()).toLocaleString();
        const callBtns = x.type==='sos'
          ? (x.phone?`<a class="btn call" href="tel:${x.phone}">${t[lng].call}</a>`:'') +
            (x.phone2?` <a class="btn call" href="tel:${x.phone2}">${t[lng].altCall}</a>`:'')
          : '';
        const mapBtn = x.link ? `<a class="btn" target="_blank" rel="noopener" href="${x.link}">${t[lng].map}</a>` : '';
        return `
          <article class="card">
            <div class="meta">
              <span>${whenStr}</span> <span>‚Ä¢</span> <span>${badge(x.type,lng)}</span>
            </div>
            <h3>${iconFor(x.type)} ${x.title}</h3>
            <div>${x.details}</div>
            <div class="meta">üìç ${x.area}</div>
            <div class="actions-row">
              ${callBtns}
              ${mapBtn}
              <button class="btn" onclick="share('${x.title} ‚Äî ${x.details}')">${t[lng].share}</button>
            </div>
          </article>
        `;
      }).join('') || `<div class="empty">${t[lng].empty}</div>`;
    }

    // ---------- Events ----------
    searchInput.addEventListener('input', (e)=>{ state.search=e.target.value.trim(); render(); });
    sortSelect.addEventListener('change', (e)=>{ state.sort=e.target.value; render(); });
    langSelect.addEventListener('change', (e)=>{ state.lang=e.target.value; applyLang(); });

    document.querySelectorAll('#chips .chip').forEach(c => c.addEventListener('click', ()=>{
      document.querySelectorAll('#chips .chip').forEach(ch => ch.classList.remove('active'));
      c.classList.add('active');
      state.section = c.dataset.section;
      navbtns.forEach(n=> n.classList.toggle('active', n.dataset.section===state.section));
      render();
    }));
    navbtns.forEach(n => n.addEventListener('click', ()=>{
      navbtns.forEach(x=>x.classList.remove('active'));
      n.classList.add('active');
      state.section = n.dataset.section;
      document.querySelectorAll('#chips .chip').forEach(ch => ch.classList.toggle('active', ch.dataset.section===state.section));
      render();
    }));

    // Share
    function share(text){
      if (navigator.share) navigator.share({title:'MyGhatkopar', text}).catch(()=>{});
      else navigator.clipboard.writeText(text);
    }
    window.share = share;

    // Dark mode
    darkToggle.addEventListener('click', ()=>{ state.dark=!state.dark; applyDark(); });

    // Before-install prompt tip
    window.addEventListener('beforeinstallprompt', (e)=>{
      e.preventDefault();
      document.getElementById('installTip').style.display='block';
    });

    // ---------- Init ----------
    (function init(){
      // restore settings
      if(!['en','hi','mr'].includes(state.lang)) state.lang='en';
      applyDark();
      applyLang();
    })();
  </script>
</body>
</html>
